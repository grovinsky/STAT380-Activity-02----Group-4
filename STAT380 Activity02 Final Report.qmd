---
title: "STAT380 Activity 02"
author: "Grace Rovinsky, Min Liu, Jiya Patel"
format: pdf
---

## I. Introduction/Background
The Nittany Valley Insurance Company wants to develop a predictive model for health insurance policy charges based on beneficiary characteristics. Understanding the factors that influece insurance costs enables more accurate pricing, risk assesment, and resource allocation. The objective is to build a linear regression model that predicts total medical charges billed to the policy based on available predictor variables. The analysis follows the modeling cycle: exploratory data analysis, model buildings, evaluation, and refinement to deliver actionable insights to the insurance company.

## II. Data Exploration
The data contains 1,338 observations with 9 variables: age, sex, bmi, children, smoker, region, charges, month, priorclaims.
A description of the data that incorporates visualizations, descriptive/incisive statistics, and narrative text describing the data (i.e., EDA)
```{r}
#| echo: false
# add narrative text for each visualization
# Descriptive:
#1. Insurance holder ages per region
ggplot(insurance_data, aes(x = age, y = region)) +
  geom_dotplot(binwidth = 0.2)+
    labs(
    x = "Age (years)",
    y = "Region",
    title = "Insurance holder ages per region"
    )+
  theme_minimal()

#2. Sex of insurance holder vs number of prior claims
ggplot(insurance_data) +
 aes(x = priorclaims, y = sex, fill = smoker) +
 geom_boxplot() +
 scale_fill_hue(direction = 1) +
  labs(
    x = "Number of Prior Claims",
    y = "Sex",
    colour = "Smoker",
    title = "Sex of insurance holder vs number of prior claims based on smoker status"
  )+
 theme_minimal()

#3. Insurance holder age vs total charges
ggplot(insurance_data, aes(x=age, y=charges))+
  geom_hex(bins=20, linewidth = 1)+
  labs(
    x = "Age (years)",
    y = "Insurance charges (USD)"
  )

ggplot(insurance_data, aes(x=age, y=charges))+
  geom_point()+
  labs(
    x = "Age (years)",
    y = "Insurance charges (USD)"
  )

#4. 
ggplot(insurance_data, aes(x= priorclaims, y= charges))+
  geom_point()+
  theme_bw()+
  labs(
    x = "Number of Prior Claims",
    y = "Insurance Charges (USD)",
    title = "Prior Claims vs Charges based on Sex and Region"
  )+
  facet_grid(rows=vars(sex), cols=vars(region))


# Inferential: confidence interval/regression line

```

## III. Modeling Methods/Strategies
At least two candidate models, professional looking discussion of the candidate models and the process by which you arrived at them. All decisions should be documented and justified.
- Multiple linear regression
```{r}
# Model 1
insuranceData <- data.frame(insurance_data)
insuranceData <- insuranceData %>%
  mutate(
    smokes = ifelse(smoker == "yes", 1, 0),
    Sex = ifelse(sex == "female", 1, 0))
View(insuranceData)
insuranceModel1 <- lm(charges ~ age + smokes + priorclaims, data = insuranceData)
summary(insuranceModel1)

insuranceModeltest <- lm(charges ~ Sex + children + bmi, data = insuranceData)
summary(insuranceModeltest)
# Model 2

```


## IV. Results
A. Initial Results

B. Interpretations
Interpretations of Model Coefficients and Intercept

C. Model Evaluation
Discussion of the candidate/final model, Evaluation/Validation of the Candidate and Final Model(s): Build as complete of a body of evidence both for and against your candidate/final model.

D. Refinements

## V. Final Recommendations
A paragraph to summarize your recommended model and key findings.

## VI. Author Contributions/Responsibilities

# VII. Code Appendix
```{r}
#| echo: false

## Load necessary packages
library(tidyverse)
library(ggplot2)
library(esquisse)

## Read dataset
insurance_data <- read.csv("~/Downloads/insurance_data_S26.csv")

```

## Once we have final model, email Abby for final check to run on model
## Need to state: How we used the data, variable/model selection process, our metric for model performance
